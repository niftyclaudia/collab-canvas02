{
  "rules": {
    "sessions": {
      "main": {
        "users": {
          ".read": "auth != null",
          "$userId": {
            ".write": "auth != null && auth.uid == $userId",
            "cursor": {
              ".write": "auth != null && (auth.uid == $userId || !data.exists())"
            },
            "presence": {
              ".write": "auth != null && (auth.uid == $userId || !data.exists())"
            }
          }
        }
      }
    }
  }
}
